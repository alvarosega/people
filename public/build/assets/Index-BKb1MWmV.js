import{j as e,H as v,r as w}from"./app-BKfOqTMF.js";import{A as _}from"./AuthenticatedLayout-C2R_dg5o.js";import"./transition-BC6w5YbO.js";import"./ThemeToggle-DVrhrRCS.js";function F({auth:t,registros:r=[]}){var p,x;const n=a=>{if(a==null)return 0;if(typeof a=="number")return Number.isFinite(a)?a:0;let s=String(a).trim().replace(/\$/g,"").replace(/\u00A0/g,"").replace(/\s/g,"");const i=s.includes(","),d=s.includes(".");i&&d?s.lastIndexOf(",")>s.lastIndexOf(".")?s=s.replace(/\./g,"").replace(",","."):s=s.replace(/,/g,""):i&&(s=s.replace(",","."));const o=Number(s);return Number.isFinite(o)?o:0},l=a=>{if(a==null)return 0;let s=String(a).replace(/%/g,"").trim();if(s=s.replace(/\u00A0/g,"").replace(/\s/g,""),s=s.replace(",","."),(s.match(/\./g)||[]).length>1){const d=s.lastIndexOf(".");s=s.slice(0,d).replace(/\./g,"")+s.slice(d)}const i=Number(s);return Number.isFinite(i)?i<=2?i:i/100:0},m=(a,s={})=>(Number.isFinite(a)?a:0).toLocaleString("es-AR",{minimumFractionDigits:2,...s}),c=(a,s={})=>(Number.isFinite(a)?a:0).toLocaleString("es-AR",{maximumFractionDigits:0,...s});return e.jsxs(_,{user:t.user,header:e.jsx("h2",{className:"font-display font-bold text-2xl text-text-primary leading-tight",children:"Panel de Usuario"}),children:[e.jsx(v,{title:"Dashboard Usuario"}),e.jsx("div",{className:"min-h-screen bg-primary",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsxs("h1",{className:"text-4xl font-display font-bold text-text-primary mb-4",children:["Bienvenido,"," ",e.jsx("span",{className:"text-accent",children:((p=t==null?void 0:t.user)==null?void 0:p.nombre)??((x=t==null?void 0:t.user)==null?void 0:x.name)??"Usuario"})]}),e.jsx("p",{className:"text-lg text-text-secondary max-w-2xl mx-auto",children:"Aqu칤 puedes consultar todos tus registros de pagos y bonificaciones de manera clara y organizada."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-10",children:[e.jsx(j,{title:"Total de Registros",value:c(r.length),icon:"游늵",description:"Registros en tu historial"}),e.jsx(j,{title:"Promedio de Pago",value:`$${m(r.reduce((a,s)=>{const i=s.pago_porcentaje_decimal!==void 0?n(s.pago_porcentaje_decimal):l(s.pago_porcentaje),d=n(s.variable_100),o=n(s.devol_alimen),g=n(s.dev_territorio),b=n(s.dev_casa);return a+d*i+o+g+b},0)/Math.max(r.length,1))}`,icon:"游눯",description:"Valor promedio por per칤odo"}),e.jsx(j,{title:"칔ltimo Per칤odo",value:r.length>0?r[0].fecha_display||r[0].fecha:"N/A",icon:"游늰",description:"Per칤odo m치s reciente"})]}),e.jsxs("div",{className:"bg-secondary rounded-2xl p-8 shadow-soft border border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[e.jsx("h2",{className:"text-2xl font-display font-semibold text-text-primary mb-4 md:mb-0",children:"Mis Registros de Base Llegada"}),e.jsxs("div",{className:"text-sm text-text-secondary",children:[r.length," registro",r.length!==1?"s":""," encontrado",r.length!==1?"s":""]})]}),r&&r.length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:r.map((a,s)=>e.jsx(k,{r:a,authUser:t.user,n:m,parseNumber:n,normalizePercentFactor:l},a.id??s))}):e.jsx(A,{})]})]})})]})}function j({title:t,value:r,icon:n,description:l}){return e.jsx("div",{className:"bg-secondary rounded-2xl p-6 shadow-soft border border-gray-200 dark:border-gray-800 transition-all duration-200 hover-lift",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-text-secondary uppercase tracking-wide mb-1",children:t}),e.jsx("p",{className:"text-2xl font-display font-bold text-text-primary",children:r}),e.jsx("p",{className:"text-xs text-text-secondary mt-1",children:l})]}),e.jsx("span",{className:"text-3xl opacity-80",children:n})]})})}function k({r:t,authUser:r,n,parseNumber:l,normalizePercentFactor:m}){var u,y;const[c,p]=w.useState(!1),x=t.pago_porcentaje_decimal!==void 0?l(t.pago_porcentaje_decimal):m(t.pago_porcentaje),a=x*100,s=l(t.variable_100),i=l(t.devol_alimen),d=l(t.dev_territorio),o=l(t.dev_casa),g=s*x,b=i+d+o,h=g+b,f=a<100?{bg:"bg-functional-red/10",border:"border-functional-red/20",badge:"bg-functional-red/20 text-functional-red"}:Math.abs(a-100)<.001?{bg:"bg-gray-200 dark:bg-gray-700",border:"border-gray-300 dark:border-gray-600",badge:"bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300"}:{bg:"bg-functional-green/10",border:"border-functional-green/20",badge:"bg-functional-green/20 text-functional-green"};return e.jsxs("div",{className:`rounded-2xl border p-6 transition-all duration-200 hover-lift ${f.bg} ${f.border}`,children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-display font-semibold text-text-primary truncate mb-1",children:((u=t.usuario)==null?void 0:u.nombre)||(r==null?void 0:r.nombre)||"N/A"}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[e.jsxs("span",{className:"bg-primary px-2 py-1 rounded-lg text-text-secondary",children:["Legajo: ",t.legajo||(r==null?void 0:r.legajo)||"N/A"]}),e.jsxs("span",{className:"bg-primary px-2 py-1 rounded-lg text-text-secondary",children:["Regi칩n: ",((y=t.usuario)==null?void 0:y.region)||(r==null?void 0:r.region)||"N/A"]})]})]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${f.badge}`,children:[n(a),"%"]})]}),e.jsxs("div",{className:"text-sm text-text-secondary space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Per칤odo:"})," ",t.fecha_display||t.fecha||"-"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Anillo:"})," ",t.anillo||"-"]}),t.fecha_pago_display&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Pago realizado:"})," ",t.fecha_pago_display]})]})]}),e.jsxs("div",{className:"text-center mb-4 py-3 bg-primary rounded-xl",children:[e.jsx("p",{className:"text-sm text-text-secondary mb-1",children:"Porcentaje de Pago"}),e.jsxs("p",{className:"text-3xl font-display font-bold text-text-primary",children:[n(a),"%"]})]}),e.jsxs("div",{className:"mb-4 rounded-xl bg-primary p-4 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Alcanzado"}),e.jsxs("span",{className:"font-display font-semibold text-text-primary",children:["$",n(g)]})]}),c&&e.jsx("div",{className:"mb-3 ml-4 pl-3 border-l-2 border-gray-300 dark:border-gray-600 animate-slide-up",children:e.jsxs("div",{className:"flex justify-between text-xs text-text-secondary",children:[e.jsx("span",{children:"Meta al 100%"}),e.jsxs("span",{className:"font-medium",children:["$",n(s)]})]})}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Total Bonos"}),e.jsxs("span",{className:"font-display font-semibold text-text-primary",children:["$",n(b)]})]}),c&&e.jsxs("div",{className:"mb-3 ml-4 pl-3 border-l-2 border-gray-300 dark:border-gray-600 space-y-2 animate-slide-up",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-text-secondary",children:"Alimentaci칩n"}),e.jsxs("span",{className:"font-medium text-text-primary",children:["$",n(i)," (",t.dias_alim," d칤as)"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-text-secondary",children:"Territorio"}),e.jsxs("span",{className:"font-medium text-text-primary",children:["$",n(d)," (",t.dias_terr," d칤as)"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-text-secondary",children:"Casa"}),e.jsxs("span",{className:"font-medium text-text-primary",children:["$",n(o)," (",t.dias_casa," d칤as)"]})]})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-base font-display font-semibold text-text-primary",children:"Pago Calculado"}),e.jsxs("span",{className:"text-lg font-display font-bold text-accent",children:["$",n(h)]})]})})]}),c&&t.comentario&&e.jsxs("div",{className:"mb-4 p-3 bg-accent/10 rounded-xl border border-accent/20 animate-fade-in",children:[e.jsx("p",{className:"text-sm font-medium text-text-secondary mb-1",children:"Comentario"}),e.jsx("p",{className:"text-sm text-text-primary italic",children:t.comentario})]}),e.jsx("button",{onClick:()=>p(N=>!N),className:"w-full rounded-xl bg-secondary hover:bg-gray-200 dark:hover:bg-gray-700 px-4 py-3 text-sm font-medium text-text-primary transition-all duration-200 hover-lift focus:outline-none focus:ring-2 focus:ring-accent/20",children:c?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})}),"Ocultar detalles"]}):e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),"Ver detalles de montos"]})})]})}function A(){return e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-text-secondary mb-4",children:e.jsx("svg",{className:"h-20 w-20 mx-auto opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-xl font-display font-semibold text-text-primary mb-2",children:"No tienes registros a칰n"}),e.jsx("p",{className:"text-text-secondary max-w-md mx-auto",children:"Los registros aparecer치n aqu칤 autom치ticamente cuando se carguen en el sistema. Puedes contactar con administraci칩n si crees que deber칤as tener registros visibles."})]})}export{F as default};
