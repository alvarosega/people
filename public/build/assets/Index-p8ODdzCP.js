import{r as c,b as T,j as e,H as pe,L as ue}from"./app-948RLx-n.js";import{A as ge}from"./AuthenticatedLayout-Dd1w4HMp.js";import"./transition-B8yT2NZC.js";import"./ThemeToggle-BoAj17fM.js";function ve({auth:s,registros:o,totalPagos:k,usuariosUnicos:d,promedioPago:b,search:_}){var Y,Z,ee;const n=t=>{if(t==null)return 0;if(typeof t=="number")return Number.isFinite(t)?t:0;let a=String(t).trim().replace(/\$/g,"").replace(/\u00A0/g,"").replace(/\s/g,"");const r=a.includes(","),l=a.includes(".");r&&l?a.lastIndexOf(",")>a.lastIndexOf(".")?a=a.replace(/\./g,"").replace(",","."):a=a.replace(/,/g,""):r&&(a=a.replace(",","."));const i=Number(a);return Number.isFinite(i)?i:0},m=t=>{if(t==null)return 0;let a=String(t).replace(/%/g,"").trim();if(a=a.replace(/\u00A0/g,"").replace(/\s/g,""),a=a.replace(",","."),(a.match(/\./g)||[]).length>1){const l=a.lastIndexOf(".");a=a.slice(0,l).replace(/\./g,"")+a.slice(l)}const r=Number(a);return Number.isFinite(r)?r<=2?r:r/100:0},x=(t,a={})=>(Number.isFinite(t)?t:0).toLocaleString("es-AR",{minimumFractionDigits:2,...a}),w=(t,a={})=>(Number.isFinite(t)?t:0).toLocaleString("es-AR",{maximumFractionDigits:0,...a}),[p,C]=c.useState(_??""),[u,I]=c.useState(""),[f,O]=c.useState(""),[h,W]=c.useState(""),[y,E]=c.useState(""),[j,H]=c.useState(""),[v,q]=c.useState(""),[N,V]=c.useState("nombre"),[g,U]=c.useState("asc"),[Q,G]=c.useState(null),[te,J]=c.useState(!1),D=c.useMemo(()=>({preserveScroll:!0,preserveState:!0,replace:!0}),[]);c.useEffect(()=>{const t=setTimeout(()=>{const a={};p&&(a.search=p),u&&(a.region=u),f&&(a.anillo=f),h&&(a.percent_min=h),y&&(a.percent_max=y),j&&(a.date_from=j),v&&(a.date_to=v),N&&(a.sort_by=N),g&&(a.sort_order=g),T.get(route("admin"),a,D)},500);return()=>clearTimeout(t)},[p,u,f,h,y,j,v,N,g]);const K=()=>{C(""),I(""),O(""),W(""),E(""),H(""),q(""),V("nombre"),U("asc"),T.get(route("admin"),{},D)},ae=t=>{G(t),J(!0)},se=()=>{J(!1),G(null)},X=c.useMemo(()=>{if(!(o!=null&&o.data))return[];let t=[...o.data];return t.sort((a,r)=>{var M,L,S,A;let l,i;switch(N){case"nombre":l=((M=a.usuario)==null?void 0:M.nombre)||"",i=((L=r.usuario)==null?void 0:L.nombre)||"";break;case"porcentaje":const B=a.pago_porcentaje_decimal!==void 0?n(a.pago_porcentaje_decimal):m(a.pago_porcentaje),R=r.pago_porcentaje_decimal!==void 0?n(r.pago_porcentaje_decimal):m(r.pago_porcentaje);l=B*100,i=R*100;break;case"fecha":l=a.fecha_pago_display||"",i=r.fecha_pago_display||"";break;case"monto":const z=a.pago_porcentaje_decimal!==void 0?n(a.pago_porcentaje_decimal):m(a.pago_porcentaje),F=r.pago_porcentaje_decimal!==void 0?n(r.pago_porcentaje_decimal):m(r.pago_porcentaje),$=n(a.variable_100),re=n(a.devol_alimen),ne=n(a.dev_territorio),oe=n(a.dev_casa),le=$*z+re+ne+oe,ie=n(r.variable_100),ce=n(r.devol_alimen),de=n(r.dev_territorio),xe=n(r.dev_casa),me=ie*F+ce+de+xe;l=le,i=me;break;default:l=((S=a.usuario)==null?void 0:S.nombre)||"",i=((A=r.usuario)==null?void 0:A.nombre)||""}return typeof l=="string"?g==="asc"?l.localeCompare(i):i.localeCompare(l):g==="asc"?l-i:i-l}),t},[o,N,g]);return e.jsxs(ge,{user:s==null?void 0:s.user,children:[e.jsx(pe,{title:"Dashboard Admin"}),e.jsx("div",{className:"min-h-screen bg-primary",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-display font-bold text-text-primary",children:["Bienvenido,Â ",e.jsx("span",{className:"text-accent",children:((Y=s==null?void 0:s.user)==null?void 0:Y.nombre)??((Z=s==null?void 0:s.user)==null?void 0:Z.name)??"Usuario"})]}),e.jsx("p",{className:"mt-2 text-text-secondary",children:"Panel de administraciÃ³n de registros de pagos"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs(ue,{href:"/admin/base-llegada/import",className:"inline-flex items-center rounded-xl bg-accent px-6 py-3 text-black font-semibold transition-all duration-200 hover-lift focus:outline-none focus:ring-2 focus:ring-accent/40",children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),"Importar CSV"]})})]}),e.jsxs("div",{className:"mb-8 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(P,{title:"Total Registros",value:w(o==null?void 0:o.total),icon:"ðŸ“Š",trend:"up"}),e.jsx(P,{title:"Usuarios Ãšnicos",value:w(d),icon:"ðŸ‘¥",trend:"neutral"}),e.jsx(P,{title:"Total Pagos",value:`$${x(k)}`,icon:"ðŸ’°",trend:"up"}),e.jsx(P,{title:"Promedio Pago",value:`$${x(b)}`,icon:"ðŸ“ˆ",trend:"up"})]}),e.jsxs("div",{className:"mb-8 rounded-2xl bg-secondary p-4 sm:p-6 shadow-soft border border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-display font-semibold text-text-primary mb-2 md:mb-0",children:"Filtros y BÃºsqueda"}),e.jsxs("button",{onClick:K,className:"flex items-center text-sm text-text-secondary hover:text-accent transition-colors duration-200",children:[e.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),"Limpiar todos los filtros"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 gap-y-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"BÃºsqueda"}),e.jsx("input",{type:"text",value:p,onChange:t=>C(t.target.value),placeholder:"Legajo o nombre...",className:"w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-primary px-4 py-3 text-text-primary placeholder-text-secondary focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"RegiÃ³n"}),e.jsx("input",{type:"text",value:u,onChange:t=>I(t.target.value),placeholder:"Filtrar por regiÃ³n...",className:"w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-primary px-4 py-3 text-text-primary placeholder-text-secondary focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anillo"}),e.jsx("input",{type:"text",value:f,onChange:t=>O(t.target.value),placeholder:"Filtrar por anillo...",className:"w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-primary px-4 py-3 text-text-primary placeholder-text-secondary focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Ordenar por"}),e.jsxs("div",{className:"flex rounded-xl overflow-hidden border border-gray-300 dark:border-gray-700 bg-primary",children:[e.jsxs("select",{value:N,onChange:t=>V(t.target.value),className:"flex-1 px-4 py-3 bg-transparent text-text-primary focus:outline-none",children:[e.jsx("option",{value:"nombre",children:"Nombre"}),e.jsx("option",{value:"porcentaje",children:"Porcentaje"}),e.jsx("option",{value:"fecha",children:"Fecha Pago"}),e.jsx("option",{value:"monto",children:"Monto Total"})]}),e.jsx("button",{onClick:()=>U(g==="asc"?"desc":"asc"),className:"px-4 bg-secondary hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-200 border-l border-gray-300 dark:border-gray-700",children:g==="asc"?"â†‘":"â†“"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 gap-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"% MÃ­nimo"}),e.jsx("input",{type:"number",value:h,onChange:t=>W(t.target.value),placeholder:"0",min:"0",max:"100",className:"w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-primary px-4 py-3 text-text-primary placeholder-text-secondary focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"% MÃ¡ximo"}),e.jsx("input",{type:"number",value:y,onChange:t=>E(t.target.value),placeholder:"100",min:"0",max:"100",className:"w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-primary px-4 py-3 text-text-primary placeholder-text-secondary focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Desde"}),e.jsx("input",{type:"date",value:j,onChange:t=>H(t.target.value),className:"w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-primary px-4 py-3 text-text-primary focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Hasta"}),e.jsx("input",{type:"date",value:v,onChange:t=>q(t.target.value),className:"w-full rounded-xl border border-gray-300 dark:border-gray-700 bg-primary px-4 py-3 text-text-primary focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all duration-200"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:X.length>0?X.map((t,a)=>{var F,$;const r=t.pago_porcentaje_decimal!==void 0?n(t.pago_porcentaje_decimal):m(t.pago_porcentaje),l=r*100,i=n(t.variable_100),M=n(t.devol_alimen),L=n(t.dev_territorio),S=n(t.dev_casa),A=i*r,B=M+L+S,R=A+B,z=l<100?"bg-functional-red/10 text-functional-red border-functional-red/20":Math.abs(l-100)<.001?"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600":"bg-functional-green/10 text-functional-green border-functional-green/20";return e.jsxs("div",{className:"rounded-2xl bg-secondary p-4 sm:p-6 shadow-soft border border-gray-200 dark:border-gray-800 transition-all duration-200 hover-lift",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-display font-semibold text-text-primary truncate mb-1",children:((F=t.usuario)==null?void 0:F.nombre)||"N/A"}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-text-secondary",children:[e.jsxs("span",{className:"bg-primary px-2 py-1 rounded-lg",children:["Legajo: ",t.legajo]}),e.jsxs("span",{className:"bg-primary px-2 py-1 rounded-lg",children:["RegiÃ³n: ",(($=t.usuario)==null?void 0:$.region)||"N/A"]}),e.jsxs("span",{className:"bg-primary px-2 py-1 rounded-lg",children:["Anillo: ",t.anillo??"-"]})]}),e.jsxs("p",{className:"text-sm text-text-secondary mt-2",children:[e.jsx("span",{className:"font-medium",children:"PerÃ­odo:"})," ",t.fecha_display]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${z}`,children:[x(l),"%"]}),e.jsx("button",{onClick:()=>T.get(route("admin.base-llegada.edit",t.id)),className:"text-text-secondary hover:text-accent transition-colors duration-200",title:"Editar registro",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687 1.687-9.193 9.193-3.32.368.368-3.32 9.193-9.193z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.125 2.25a1.5 1.5 0 012.121 2.121l-1.687 1.687-2.121-2.121L19.125 2.25z"})]})})]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-primary rounded-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Pago calculado:"}),e.jsxs("span",{className:"text-xl font-display font-bold text-text-primary",children:["$",x(R)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Alcanzado:"}),e.jsxs("span",{className:"block font-medium text-text-primary",children:["$",x(A)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Bonos:"}),e.jsxs("span",{className:"block font-medium text-text-primary",children:["$",x(B)]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-text-secondary",children:t.fecha_pago_display}),e.jsx("button",{onClick:()=>ae(t),className:"text-sm text-accent hover:text-abinbev-gold font-medium transition-colors duration-200",children:"Ver detalles â†’"})]})]},t.id??a)}):e.jsxs("div",{className:"col-span-full py-16 text-center",children:[e.jsx("div",{className:"text-text-secondary mb-4",children:e.jsx("svg",{className:"h-20 w-20 mx-auto opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("p",{className:"text-lg text-text-secondary",children:p||u||f||h||y||j||v?"No se encontraron registros con los filtros aplicados":"No hay registros en el sistema"}),(p||u||f||h||y||j||v)&&e.jsx("button",{onClick:K,className:"mt-4 text-accent hover:text-abinbev-gold font-medium transition-colors duration-200",children:"Limpiar filtros"})]})}),((ee=o==null?void 0:o.links)==null?void 0:ee.length)>3&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx("nav",{className:"flex flex-wrap items-center justify-center gap-2",children:o.links.map((t,a)=>e.jsx("button",{disabled:!t.url,onClick:()=>t.url&&T.get(t.url,{},D),className:`min-h-[44px] min-w-[44px] flex justify-center items-center rounded-xl px-4 py-2 text-sm font-medium transition-all duration-200 ${t.active?"bg-accent text-black shadow-glow":"text-text-secondary hover:bg-secondary hover:text-text-primary"} ${t.url?"hover-lift":"opacity-30 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:t.label}},a))})})]})}),te&&Q&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 animate-fade-in",children:e.jsxs("div",{className:"bg-secondary rounded-2xl w-full sm:max-w-2xl max-h-[90vh] overflow-y-auto shadow-dark-float p-4 sm:p-6",children:[e.jsx("button",{onClick:se,className:"text-text-secondary hover:text-text-primary transition-colors duration-200 p-2 rounded-xl hover:bg-primary",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx(be,{record:Q,parseNumber:n,normalizePercentFactor:m,n:x})]})})]})}function be({record:s,parseNumber:o,normalizePercentFactor:k,n:d}){const b=s.pago_porcentaje_decimal!==void 0?o(s.pago_porcentaje_decimal):k(s.pago_porcentaje),_=b*100,n=o(s.variable_100),m=o(s.devol_alimen),x=o(s.dev_territorio),w=o(s.dev_casa),p=n*b,C=m+x+w,u=p+C;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsxs("div",{className:"bg-primary p-5 rounded-2xl",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("p",{className:"text-sm text-text-secondary mb-1",children:"Porcentaje de pago"}),e.jsxs("p",{className:"text-3xl font-display font-bold text-accent",children:[d(_),"%"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-text-secondary",children:"Meta al 100%"}),e.jsxs("span",{className:"font-display font-semibold text-text-primary",children:["$",d(n)]})]}),e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-text-secondary",children:"Alcanzado"}),e.jsxs("span",{className:"font-display font-semibold text-text-primary",children:["$",d(p)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-text-secondary mb-3",children:"Bonos"}),e.jsxs("div",{className:"space-y-2 pl-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"AlimentaciÃ³n:"}),e.jsxs("span",{className:"font-medium text-text-primary",children:["$",d(m)," (",s.dias_alim," dÃ­as)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Territorio:"}),e.jsxs("span",{className:"font-medium text-text-primary",children:["$",d(x)," (",s.dias_terr," dÃ­as)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-text-secondary",children:"Casa:"}),e.jsxs("span",{className:"font-medium text-text-primary",children:["$",d(w)," (",s.dias_casa," dÃ­as)"]})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-200 dark:border-gray-700 mt-2",children:[e.jsx("span",{className:"font-medium text-text-primary",children:"Total bonos:"}),e.jsxs("span",{className:"font-display font-semibold text-text-primary",children:["$",d(C)]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-lg font-display font-semibold text-text-primary",children:"Pago calculado"}),e.jsxs("span",{className:"text-2xl font-display font-bold text-accent",children:["$",d(u)]})]})]})]})}),s.comentario&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-display font-semibold text-text-primary mb-3",children:"Comentario"}),e.jsx("p",{className:"text-text-primary bg-accent/10 p-4 rounded-2xl border border-accent/20",children:s.comentario})]})]})}function P({title:s,value:o,icon:k,trend:d}){const b={up:"text-functional-green",down:"text-functional-red",neutral:"text-text-secondary"},_={up:"â†—",down:"â†˜",neutral:"â†’"};return e.jsx("div",{className:"rounded-2xl bg-secondary p-4 sm:p-6 shadow-soft border border-gray-200 dark:border-gray-800 transition-all duration-200 hover-lift",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-text-secondary uppercase tracking-wide mb-1",children:s}),e.jsx("p",{className:"text-2xl font-display font-bold text-text-primary",children:o})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-2xl block mb-1",children:k}),e.jsx("span",{className:`text-xs font-semibold ${b[d]}`,children:_[d]})]})]})})}export{ve as default};
